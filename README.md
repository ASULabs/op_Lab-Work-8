#Комп’ютерний практикум № 8

#ТЕКСТОВІ ФАЙЛИ

*Мета роботи* - вивчити особливості створення і обробки текстових файлів даних.

##Теоретичні відомості

*Текстовий файл*  є сукупністю символьних рядків змінної довжини. Кінець кожного рядка у такому файлі позначається спеціальним маркером кінця рядка **Eoln**, що представляє собою пару керуючих символів: "переведення каретки" (#13) і "переведення рядка" (#10). Наприкінці файла записується маркер кінця файла — керуючий символ з кодом #26.  
Текстові файли є файлами тільки послідовного доступу.  

У С-програмах текстовий файл оголошують як змінну-покажчик стандартного типу FILE:
`FILE *покажчик`  
Структура типу **FILE** містить різноманітні відомості про файл: його ім'я, розташування на диску, режим роботи з файлом, покажчик поточної позиції і т. ін. Вона оголошена в стандартоному заголовному файлі `stdio.h`.  
Відповідність між іменем фізичного файла і покажчиком на файл у програмі встановлюється при відкритті файлу. При відкритті файлу також встановлюється і режим його обробки.   
Відкриття файлу засобами С здійснюється за допомогою функції `fopen_s`.  
Синтаксис:  

```errno_t fopen_s( 
   FILE** pFile,
   const char *filename,
   const char *mode 
);```  

Параметри:  
**pFile** - покажчик на файловий покажчик, котрий отримує покажчик на відкритий файл;  
**filename** - ім’я файлу, який відкривається;  
**mode** - режим доступу до файлу, рядок символів, що визначає потрібний статус (режим) відкриття файлу.  
Допустимі значення режимів доступу наведено у таблиці 1.  

Таблиця 1. Допустимі значення режимів доступу

| Режим   |      Призначення      |
|----------|:-------------:|
|Визначення довжини рядка| |
| r |  відкрити існуючий файл тільки для читання |
| w |  створити новий файл тільки для запису (якщо відповідний фізичний файл існує, то його вміст втрачається) |
| a |  відкрити існуючий файл для дозапису в кінець файлу або створити новий файл, якщо такого не існує |
| r+ |  відкрити існуючий файл для читання і запису |
| w+ |  створити новий файл для читання і запису (якщо відповідний фізич-ний файл існує, то його вміст втрачається) |
| a+ |  відкрити існуючий файл в режимі читання і дозапису в кінець файлу або створити новий файл, якщо такого не існує |

Ознакою відкриття саме текстового файла є додавання до рядка, що визначає режим доступу до файла, суфікса **t**. Символ **«+»** означає відкриття файла і для читання, і для запису.  
Порядок букв в рядку режиму наступний: спочатку йде одна з букв **"r"**, **"w"**, **"a"**, потім в довільному порядку можуть йти символи **"t"** та **"+"**. Тобто, рядки, подібні **"r+t"** можуть бути представлені і у вигляді **"rt+"**.  
У разі вдалого відкриття файлу функція `fopen_s` повертає 0, інакше відповідний код помилки.  
Для читання-запису текстових файлів використовують, в основному, функції рядкового та символьного введення-виведення (таблиця 2).  

Таблиця 2. Функції рядкового та символьного введення-виведення  

| Функція   |      Опис      |
|----------|:-------------:|
| `char *fgets(char *str, int n, FILE *stream);` | читання n символів із файла stream в рядок, на який вказує покажчик str  (з додаванням ’\0’) |
| `int fputs( const char *str, FILE *stream );` | запис у файл stream рядка, на який вказує покажчик str |
| `int fgetc(FILE *stream );` | читання символа із файла stream |
| `int fputc(int c, FILE *stream);` | запис символа c в файл stream |

Якщо рядок (символ) не може бути прочитаний (записаний), то повертається макрос `EOF` (стандартне значення, яке повертається тоді, коли функція введення намагається виконати читання після кінця файлу).  
У файлах, відкритих для читання і запису, потік повинен бути обнулений (очищений) після запису, перш ніж виконувати операції читання. Це може бути зроблено шляхом виклику функції `fflush()`, яка примусово записує дані з буфера у файл незалежно від ступеня заповнення буфера.  
В текстові файли, загалом, можна також вводити і несимвольні дані, зокрема, числові. При записі в текстовий файл такі дані перетворюються із внутрішньої форми подання в символьну і зберігаються в символьному вигляді; при читанні виконується зворотне перетворення.   
